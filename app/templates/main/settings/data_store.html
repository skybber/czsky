{% extends 'layouts/base.html' %}
{% import 'macros/form_macros.html' as f %}

{% block scripts %}
{% endblock %}

{% block content %}

    {% set flashes = {
        'error':   get_flashed_messages(category_filter=['form-error']),
        'info':    get_flashed_messages(category_filter=['form-info']),
        'success': get_flashed_messages(category_filter=['form-success'])
    } %}

    <div class="ui stackable centered grid container">
        <div class="fourteen wide tablet sixteen wide computer centered column">
            <a class="ui basic compact button" href="{{ url_for('main_settings.settings') }}">
                <i class="caret left icon"></i>
                Back to Settings
            </a>
            <h4 class="ui top attached block header segment">Store to Git</h4>
            <div class="ui attached segment">
                {% if git_stored %}
                    {{ f.form_message(flashes['error'], header='Something went wrong.', class='error') }}
                    {{ f.form_message(flashes['warning'], header='Something went wrong.', class='warning') }}
                    {{ f.form_message(flashes['info'], header='Information', class='info') }}
                    {{ f.form_message(flashes['success'], header='Success!', class='success') }}
                {% endif %}
                <p>This operation stores user data to git repository. Git URL={{ git_url }}</p>
                <form action="{{ url_for('main_settings.data_store') }}" method="POST">
                    <button class="ui labeled icon positive button" value="store" type="submit" name="submit">
                        <i class="download icon"></i>
                        Store data to Git
                    </button>
                    <input type="hidden" name="csrf_token" value="{{ csrf_token()|safe }}">
                </form>
            </div>

            <h4 class="ui top attached block header segment">Restore from Git</h4>
            <div class="ui attached segment">
                {% if git_restored %}
                    {{ f.form_message(flashes['error'], header='Something went wrong.', class='error') }}
                    {{ f.form_message(flashes['warning'], header='Something went wrong.', class='warning') }}
                    {{ f.form_message(flashes['info'], header='Information', class='info') }}
                    {{ f.form_message(flashes['success'], header='Success!', class='success') }}
                {% endif %}
                <p>This operation restores user data to git repository. All uncommitted data will be lost! Git URL={{ git_url }}</p>
                <form action="{{ url_for('main_settings.data_store') }}" method="POST">
                    <button class="ui labeled icon negative button" value="restore" type="submit" name="submit">
                        <i class="upload icon"></i>
                        Restore data from Git
                    </button>
                    <input type="hidden" name="csrf_token" value="{{ csrf_token()|safe }}">
                </form>
            </div>
        </div>
        </div>
    </div>
{% endblock %}